CREATE DATABASE IF NOT EXISTS `ProjetLprs_Java` DEFAULT CHARACTER SET latin1 COLLATE 
latin1_swedish_ci; 
USE `ProjetLprs_Java`;

DROP TABLE IF EXISTS `utilisateur`; 
CREATE TABLE IF NOT EXISTS `utilisateur` ( 
`id_utilisateur` int(11) NOT NULL AUTO_INCREMENT, 
`role` varchar(50) NOT NULL,
`nom` varchar(50) NOT NULL, 
`prenom` varchar(50) NOT NULL,
`mail` varchar(100) NOT NULL,
`mdp` varchar(100) NOT NULL,
`ref_commande` int(11) NOT NULL, 
`ref_demandeFourniture` int(11) NOT NULL, 
`ref_dossierInscription` int(11) NOT NULL, 
PRIMARY KEY (`id_utilisateur`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 



DROP TABLE IF EXISTS `commande`; 
CREATE TABLE IF NOT EXISTS `commande` ( 
`id_commande` int(11) NOT NULL AUTO_INCREMENT, 
`date` date NOT NULL, 
`heure` time NOT NULL,
`prenom` varchar(50) NOT NULL,
`mail` varchar(50) NOT NULL,
`ref_quantite` int(11) NOT NULL,
PRIMARY KEY (`id_commande`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 



DROP TABLE IF EXISTS `quantite`; 
CREATE TABLE IF NOT EXISTS `quantite` ( 
`id_quantite` int(11) NOT NULL AUTO_INCREMENT, 
`quantite` varchar(50) NOT NULL, 
`ref_stock` int(11) NOT NULL,
PRIMARY KEY (`id_quantite`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 



DROP TABLE IF EXISTS `demandeFourniture`; 
CREATE TABLE IF NOT EXISTS `demandeFourniture` ( 
`id_demandeFourniture` int(11) NOT NULL AUTO_INCREMENT, 
`article` varchar(50) NOT NULL, 
`quantite` varchar(50) NOT NULL,
`raison` varchar(255) NOT NULL,
`approuver` varchar(50) NOT NULL,
PRIMARY KEY (`id_demandeFourniture`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 



DROP TABLE IF EXISTS `stock`; 
CREATE TABLE IF NOT EXISTS `stock` ( 
`id_stock` int(11) NOT NULL AUTO_INCREMENT, 
`libelle` varchar(255) NOT NULL, 
`nombre_stock` varchar(255) NOT NULL,
`description` varchar(255) NOT NULL,
`ref_demandeFourniture` int(11) NOT NULL,
PRIMARY KEY (`id_stock`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1;



DROP TABLE IF EXISTS `dossierInscription`; 
CREATE TABLE IF NOT EXISTS `dossierInscription` ( 
`id_dossierInscription` int(11) NOT NULL AUTO_INCREMENT, 
`date` date NOT NULL,
`heure` time NOT NULL,
`filiere_interet` varchar(255) NOT NULL,
`motivation_etudiant` varchar(255) NOT NULL,
 
PRIMARY KEY (`id_dossierInscription`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1;



DROP TABLE IF EXISTS `liée`; 
CREATE TABLE IF NOT EXISTS `liée` ( 
  `ref_rendezVous` int(11) NOT NULL, 
  `ref_dossierInscription` int(11) NOT NULL, 
  PRIMARY KEY (`ref_rendezVous`,`ref_dossierInscription`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1;


DROP TABLE IF EXISTS `rendezVous`; 
CREATE TABLE IF NOT EXISTS `rendezVous` ( 
`id_rendezVous` int(11) NOT NULL AUTO_INCREMENT, 
`salle` varchar(50) NOT NULL,
`date` date NOT NULL,
`heure` time NOT NULL,
 `ref_utilisateur` int(11) NOT NULL, 
 
PRIMARY KEY (`id_rendezVous`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1;



DROP TABLE IF EXISTS `ficheEtudiant`; 
CREATE TABLE IF NOT EXISTS `ficheEtudiant` ( 
`id_ficheEtudiant` int(11) NOT NULL AUTO_INCREMENT, 
`nom` varchar(50) NOT NULL,
`prenom` varchar(50) NOT NULL,
`dernier_diplome` varchar(50) NOT NULL,
`email` varchar(50) NOT NULL,
`telephone` varchar(50) NOT NULL,
`ville` varchar(50) NOT NULL,
`cp` varchar(50) NOT NULL,
`rue` varchar(50) NOT NULL,
`ref_dossierInscription` int(11) NOT NULL,
`ref_utilisateur` int(11) NOT NULL,
PRIMARY KEY (`id_ficheEtudiant`) 
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 


ALTER TABLE `utilisateur` 
  ADD CONSTRAINT `fk_utilisateur_commande` FOREIGN KEY (`ref_commande`) REFERENCES `commande` 
(`id_commande`), 
  ADD CONSTRAINT `fk_utilisateur_demandeFourniture` FOREIGN KEY (`ref_demandeFourniture`) REFERENCES `demandeFourniture` 
(`id_demandeFourniture`); 
ADD CONSTRAINT `fk_utilisateur_dossierInscription` FOREIGN KEY (`ref_dossierInscription`) REFERENCES `dossierInscription` 
(`id_dossierInscription`); 


ALTER TABLE `commande` 
  ADD CONSTRAINT `fk_commande_quantite` FOREIGN KEY (`ref_quantite`) REFERENCES `quantite` 
(`id_quantite`);



ALTER TABLE `quantite` 
  ADD CONSTRAINT `fk_quantite_stock` FOREIGN KEY (`ref_stock`) REFERENCES `stock` 
(`id_stock`);



ALTER TABLE `stock` 
  ADD CONSTRAINT `fk_stock_demandeFourniture` FOREIGN KEY (`ref_demandeFourniture`) REFERENCES `demandeFourniture` 
(`id_demandeFourniture`);


ALTER TABLE `liée` 
  ADD CONSTRAINT `fk_liée_rendezVous` FOREIGN KEY (`ref_rendezVous`) REFERENCES `rendezVous` 
(`id_rendezVous`), 
  ADD CONSTRAINT `fk_liée_dossierInscription` FOREIGN KEY (`ref_dossierInscription`) REFERENCES `dossierInscription` 
(`id_dossierInscription`); 



ALTER TABLE `rendezVous` 
  ADD CONSTRAINT `fk_rendezVous_utilisateur` FOREIGN KEY (`ref_utilisateur`) REFERENCES `utilisateur` 
(`id_utilisateur`);



ALTER TABLE `ficheEtudiant` 
  ADD CONSTRAINT `fk_ficheEtudiant_dossierInscription` FOREIGN KEY (`ref_dossierInscription`) REFERENCES `dossierInscription` 
(`id_dossierInscription`), 
  ADD CONSTRAINT `fk_ficheEtudiant_utilisateur` FOREIGN KEY (`ref_utilisateur`) REFERENCES `utilisateur` 
(`id_utilisateur`); 












